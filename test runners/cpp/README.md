# Testing C++ functions
We will test C++ functions using Google Test.

## Process Breakdown
### 1. Install Googe Tests and Make
If you have not installed `Google Tests` in your machine, you will need to install it.
In Debian-based Linux distributions, it can be done as follows:
```bash
$ sudo apt install libgtest-dev make
```
In MacOS platforms, you can install google tests using homebrew:
```bash
$ brew install googletest
```

In Windows platforms, please refer to [this tutorial](https://medium.com/swlh/google-test-installation-guide-for-c-in-windows-for-visual-studio-code-2b2e66352456) or search on the internet.
### 2. Place the test files inside the following directory structure:

```bash
TaskXXXXXX/
├── include/            # Folder for header files
│   └── prototype.h     # Prototype for the function being tested
├── src/                # Folder for source files (different versions)
│   ├── A.cpp           # Function generated by Model A
│   ├── B.cpp           # Function generated by Model B
│   ├── C.cpp           # Function generated by Model C
│   ├── ideal.cpp       # Function from the ideal response
│   ├── incorrect.cpp   # Function from the incorrect response
│   └── base.cpp        # Function from the base case
├── test/               # Folder for the test files
|   └── test_file.cpp   # C++ file with the test cases to run
└── makefile            # The makefile to run all test cases on all files
```
### 3. Edit the `prototype.h` file to hold the prototype of the function you are testing:
```cpp
#ifndef PROTOTYPE_H  // Include guard
#define PROTOTYPE_H

// Add all necessary libraries to run the function here.
// For example, my function needed cmath and limits.
#include <cmath>
#include <limits>

// Change this function prototype for the function you will be testing.
double calculate_exp(double x, long n);

#endif
```
### 4. Add the following statement as the first line to all `.cpp` files, including the test file:
```cpp
#include "../include/prototype.h"
```
### 5. Comment all `main` functions
We must comment or rename all `main` functions from the files, other than `test_file.cpp`. If they remain as `main` the tests won't work.

### 6. Edit the makefile as follows:
```makefile
# Makefile - Please preserve indentation with TAB characters

# If you installed Google Test system-wide, this is not needed:
GTEST_DIR = /path/to/gtest  # Replace with the path to your Google Test installation

# Define the versions to test (just the names of the C files)
VERSIONS = A B C base ideal incorrect

all: $(VERSIONS)

# Rule for each version
$(VERSIONS):
		mkdir -p build_$@
		g++ ./src/$@.cpp ./test/exponent_test.cpp -o build_$@/exponent_test -lgtest -std=c++11

# Type "make clean" to remove previous compilation directories and log files
clean:
		rm -rf build_*
		rm -rf *log

# Type "make run" to compile all versions and run the test cases on all files
# The system will output separate log files for each execution.
run: all
		@for version in $(VERSIONS); do \
				echo "Running tests for $$version..."; \
				./build_$$version/exponent_test > Results_$$version.log; \
				echo "Wrote log file Results_$$version.log."; \
		done
```
### 7. Clean, Compile, and Run the Tests
Now, all we need to do is compile and run the tests. The following command does it:
```bash
$ make run
```
The system will create log files for all executions that were possible to run.

If there are old results, and you want to execute again after some changes, you can run the following command. Beware, because it cleans all result `.log` files and compilations previously done:
```bash
$ make clean
```
